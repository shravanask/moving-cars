<html>
<body>
	<div>
		<input type="button" id="connectBtn" value="CONNECT" onclick="connect()" /> 
	</div>
	<div>
		<input type="text" id="carAddIndex" value="1,1"/> 
		<input type="button" id="sendBtn" value="ADD CAR" onclick="send()" disabled="disabled" />
	</div>
	<div id="output">
		<p>Output</p>
	</div>
</body>
<script type="text/javascript">
	var webSocket;
	var output = document.getElementById("output");
	var connectBtn = document.getElementById("connectBtn");
	var sendBtn = document.getElementById("sendBtn");

	function connect() {
		// oprn the connection if one does not exist
		if (webSocket !== undefined
				&& webSocket.readyState !== WebSocket.CLOSED) {
			return;
		}
		// Create a websocket
		webSocket = new WebSocket("ws://localhost:8080/carSocket");

		webSocket.onopen = function(event) {
			updateOutput("Connected!");
			connectBtn.disabled = true;
			sendBtn.disabled = false;

		};

		webSocket.onmessage = function(event) {
			updateOutput(event.data);
		};

		webSocket.onclose = function(event) {
			updateOutput("Connection Closed");
			connectBtn.disabled = false;
			sendBtn.disabled = true;
		};
	}

	function send() {
		var carMapIndex = document.getElementById("carAddIndex").value;
		var direction = "RIGHT";
		var carPayload = {"carMapIndex" : carMapIndex, "direction" : direction};
		webSocket.send(JSON.stringify(carPayload));
	}

	function closeSocket() {
		webSocket.close();
	}

	function updateOutput(text) {
		output.innerHTML += "<br/>" + text;
	}
</script>
</html>
